<!DOCTYPE html>
<div class="message"></div>
<div class="error"></div>
<div class="rpcMessages"></div>
<div class="global" style="display: none" data-spreadsheet-url="<?= spreadsheetUrl ?>"></div>
<table>
  <?
    for (var i = 0; i < trackedSheets.length; i++) {
      var preferences = trackedSheets[i];
  ?>
  <tr class="sheetController"
      data-sheet-id="<?= preferences.sheetId ?>"
      data-sheet-name="<?= preferences.sheetName ?>">
    <td data-templated-name="{sheetName}">???</td>
    <td>
      <div class="labelPicker"
          data-label-name="<?= preferences.label || '' ?>"
          data-max-threads="<?= preferences.maxThreads ?>">
        <div class="labelDisplayMode">
          <span class="labelName"></span>
          <a class="syncWithGmail labelOnly">Sync with Gmail</a>
        </div>
        <div class="labelSelectMode">
          <select class="selectLabel">
          </select>
          <input type="text" class="maxThreads">
          <a class="saveLabel">Save</a>
          <a class="cancelLabel">Cancel</a>
          <a class="removeLabel">Remove</a>
          <a class="renameLabel">Rename</a>
        </div>
      </div>
    </td>
    <td>
      <a class="organize">Organize</a>
    </td>
    <td>
      <a class="addUrl">Add URL</a>
    </td>
  </tr>
  <?
    }
  ?>
</table>
<?
  if (untrackedSheets.length > 0) {
?>
<h1>Untracked</h1>
<table>
  <?
    for (var i = 0; i < untrackedSheets.length; i++) {
      var sheetInfo = untrackedSheets[i];
  ?>
  <tr class="sheetController"
      data-sheet-id="<?= sheetInfo.sheetId ?>"
      data-sheet-name="<?= sheetInfo.sheetName ?>">
    <td data-templated-name="{sheetName}"><?= sheetInfo.sheetName ?></td>
    <td><a class="addTracking">Track</a></td>
  </tr>
  <?
    }
  ?>
</table>
<?
  }
?>
<h1>All Sheets</h1>
<button class="organizeAll">Organize All</button>
<button class="updateOverview">Update Overview</button>
<script>
  <?!= include("ui/JavascriptRpcConfig"); ?>
  <?!= include("ui/JavascriptLabelPicker"); ?>
  <?!= include("ui/JavascriptSheetController"); ?>
  <?!= include("ui/JavascriptGlobalController"); ?>
  <?!= include("ui/JavascriptControls"); ?>
</script>
