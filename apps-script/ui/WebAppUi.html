<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <?= Session.getActiveUser().getEmail() ?>
    <?!= include("ui/Stylesheet"); ?>
    <?
      if (spreadsheetUrl) {
    ?>
      <?!= renderControls(spreadsheetUrl) ?>
      <a class="clearSpreadsheetUrl">Clear Spreadsheet URL</a>
      <script>
        function clearSpreadsheetUrl() {
          new RpcConfig(runner => runner.clearSpreadsheetUrl()).
              output('Clearing spreadsheet url...').
              retryOnTimeout().
              callRpc();
          }
        $('.clearSpreadsheetUrl').click(clearSpreadsheetUrl);
      </script>
    <? } else { ?>
      <div class="rpcMessages"></div>
      <input type="text" class="spreadsheetUrl"> <button class="setSpreadsheetUrl">Set Spreadsheet URL</button>
      <script>
        <?!= include("ui/JsRpcConfig"); ?>
        function setSpreadsheetUrl() {
          console.log($('.spreadsheetUrl').val());
          new RpcConfig(runner => runner.setSpreadsheetUrl($('.spreadsheetUrl').val())).
              output('Setting spreadsheet url...').
              retryOnTimeout().
              callRpc();
        }
        $('.setSpreadsheetUrl').click(setSpreadsheetUrl);
      </script>
    <? } ?>
  </body>
</html>
